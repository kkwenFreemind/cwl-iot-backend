server:
  port: 8989

spring:
  datasource:
    type: com.alibaba.druid.pool.DruidDataSource
    driver-class-name: org.postgresql.Driver
    url: jdbc:postgresql://localhost:15432/cwl-iot-db?useUnicode=true&characterEncoding=UTF-8&serverTimezone=Asia/Taipei
    username: postgres
    password: 
  data:
    redis:
      database: 0
      host: localhost
      port: 16379
      # 如果Redis 服務未設定密碼，需要將password刪掉或註釋，而不是設定為空字串
      # password: 123456
      timeout: 10s
      lettuce:
        pool:
          # 連線池最大連線數 預設8 ，負數表示沒有限制
          max-active: 8
          # 連線池最大阻塞等待時間（使用負值表示沒有限制） 預設-1
          max-wait: -1
          # 連線池中的最大空閒連線 預設8
          max-idle: 8
          # 連線池中的最小空閒連線 預設0
          min-idle: 0
  cache:
    enabled: false
    # 快取型別 redis、none(不使用快取)
    type: redis
    # 快取時間(單位：ms)
    redis:
      time-to-live: 3600000
      # 快取null值，防止快取穿透
      cache-null-values: true
    caffeine:
      spec: initialCapacity=50,maximumSize=1000,expireAfterWrite=600s



# 安全配置
security:
  session:
    type: jwt # 會話方式 jwt/redis-token
    access-token-time-to-live: 7200   # 訪問令牌 有效期(單位：秒)，預設 2 小時，-1 表示永不過期
    refresh-token-time-to-live: 604800 # 重新整理令牌有效期(單位：秒)，預設 7 天，-1 表示永不過期
    jwt:
      secret-key: SecretKey012345678901234567890123456789012345678901234567890123456789 # JWT金鑰(HS256演演算法至少32字元)
    redis-token:
      allow-multi-login: true # 是否允許多裝置登入
  # 安全白名單路徑，僅跳過 AuthorizationFilter 過濾器，還是會走 Spring Security 的其他過濾器(CSRF、CORS等)
  ignore-urls:
    - /api/v1/auth/login/**       # 登入介面(賬號密碼登入、手機驗證碼登入和微信登入)
    - /api/v1/auth/captcha        # 驗證碼獲取介面
    - /api/v1/auth/refresh-token  # 重新整理令牌介面
    - /api/v1/auth/logout         # 開放退出登入
    - /api/v1/notices/**          # 通知公告介面 (臨時開放用於JPA測試)
    - /ws/**                      # WebSocket介面
  # 非安全端點路徑，完全繞過 Spring Security 的安全控制
  unsecured-urls:
    - ${springdoc.swagger-ui.path}
    - /doc.html
    - /swagger-ui/**
    - /v3/api-docs/**
    - /webjars/**
    - /favicon.ico


# 檔案儲存配置
oss:
  # OSS 型別 (目前支援aliyun、minio、local)
  type: minio
  # MinIO 物件儲存服務
  minio:
    # MinIO 服務地址
    endpoint: http://localhost:9000
    # 訪問憑據
    access-key: minioadmin
    # 憑據金鑰
    secret-key: minioadmin
    # 儲存桶名稱
    bucket-name: ccms
    # (可選) 自定義域名：配置後，檔案 URL 會使用該域名格式
    custom-domain:
  # # 阿里雲OSS物件儲存服務
  # aliyun:
  #   # 服務Endpoint
  #   endpoint: oss-cn-hangzhou.aliyuncs.com
  #   # 訪問憑據`
  #   access-key-id: your-access-key-id
  #   # 憑據金鑰
  #   access-key-secret: your-access-key-secret
  #   # 儲存桶名稱
  #   bucket-name: default
  # # 本地儲存
  local:
    # 檔案儲存路徑 請注意下，mac使用者請使用 /Users/your-username/your-path/，否則會有許可權問題，windows使用者請使用 D:/your-path/
    storage-path: /Users/theo/home/

# springdoc配置： https://springdoc.org/properties.html
springdoc:
  swagger-ui:
    path: /swagger-ui.html
    operations-sorter: alpha
    tags-sorter: alpha
  api-docs:
    path: /v3/api-docs
  group-configs:
    - group: '系統管理'
      paths-to-match: "/**"
      packages-to-scan:
        - community.waterlevel.iot.auth.controller
        - community.waterlevel.iot.system.controller
        - community.waterlevel.iot.shared.file.controller
        - community.waterlevel.iot.shared.codegen.controller
  default-flat-param-object: true



# 驗證碼配置
captcha:
  # 驗證碼型別 circle-圓圈幹擾驗證碼|gif-Gif驗證碼|line-幹擾線驗證碼|shear-扭曲幹擾驗證碼
  type: circle
  # 驗證碼寬度
  width: 120
  # 驗證碼高度
  height: 40
  # 驗證碼幹擾元素個數
  interfere-count: 2
  # 文字透明度(0.0-1.0)
  text-alpha: 0.8
  # 驗證碼字元配置
  code:
    # 驗證碼字元型別 math-算術|random-隨機字元
    type: math
    # 驗證碼字元長度，type=算術時，表示運算位數(1:個位數運算 2:十位數運算)；type=隨機字元時，表示字元個數
    length: 1
  # 驗證碼字型
  font:
    # 字型名稱 Dialog|DialogInput|Monospaced|Serif|SansSerif
    name: SansSerif
    # 字型樣式 0-普通|1-粗體|2-斜體
    weight: 1
    # 字型大小
    size: 24
  # 驗證碼有效期(秒)
  expire-seconds: 120



